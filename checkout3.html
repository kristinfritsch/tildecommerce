
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Life is about balance and happiness. <br/> Tilde is your home directory, where inspiration and creativity begins.">
    <meta name="author" content="">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">


    <meta name="twitter:card" content="summary">
    <meta name="title" content="Tilde.id">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="en-id">


    <!-- open graph metadata facebook, slack, whatsapp line -->
    <meta property="fb:app_id" content="150112802189143"/>
    <meta property="og:locale" content="en_US" />
    <meta property="og:title" content="Tilde.id" />
    <meta property='og:site_name' content='Tilde.id, the Living Community' />
    <meta property="og:url" content="http://kimistatic.s3-website-ap-southeast-1.amazonaws.com/" />
    <meta property="og:description" content="Tilde.id, the Living Community" />
    <meta property='og:image' content="https://s3-ap-southeast-1.amazonaws.com/static.tilde.id/images/apple-touch-icon.png" />


    <!-- open graph metadata twitter -->
    <meta name="twitter:title" content="Tilde.id">
    <meta name="twitter:url" content="http://www.tilde.id">
    <meta name="twitter:description" content="Tilde.id, the Living Community">
    <meta name="twitter:image" content="https://s3-ap-southeast-1.amazonaws.com/static.tilde.id/images/apple-touch-icon.png">
    <meta name="twitter:site" content="@tildeofficial">


    <link rel="icon" href="https://s3-ap-southeast-1.amazonaws.com/static.tilde.id/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://s3-ap-southeast-1.amazonaws.com/static.tilde.id/images/apple-touch-icon.png">

    <title>Tilde Commerce</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="css/kimi.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">

    <!-- owl carousel -->
    <link rel="stylesheet" href="css/owl_carousel/owl.carousel.css">
    <link rel="stylesheet" href="css/owl_carousel/owl.theme.default.css">

    <!-- slick carousel -->
    <link rel="stylesheet" type="text/css" href="css/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="css/slick/slick-theme.css"/>

    <!--tipue search-->
    <link rel="stylesheet" href="css/tipuesearch/tipuesearch.css">

    <!-- jasny -->
    <link rel="stylesheet" href="css/jasny/jasny-bootstrap.css">

</head>

<body>

<div class="navmenu navmenu-default navmenu-fixed-left offcanvas">
  <a class="navmenu-brand" href="index.html">Tilde</a>
  <ul class="nav navmenu-nav">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Shop <b class="caret"></b></a>
      <ul class="dropdown-menu navmenu-nav">
        <li><a href="#">Bedding</a></li>
        <li><a href="#">Lighting</a></li>
        <li><a href="#">Pillow and Decor</a></li>
        <li><a href="#">Wall Art and Mirror</a></li>
        <li><a href="#">Table Top</a></li>
        <li><a href="#">Glassware</a></li>
      </ul>
    </li>
    <li><a href="photos.html">Photos</a></li>
    <li><a href="articles.html">Stories</a></li>
    <li><a href="questions.html">FAQs</a></li>
    <li><a href="contact.html">Contact Us</a></li>
    <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Furniture <b class="caret"></b></a>
          <ul class="dropdown-menu navmenu-nav">
            <li><a href="#">Living Room</a></li>
            <li><a href="#">Dining Room and Kitchen</a></li>
            <li><a href="#">Bed Room</a></li>
            <li><a href="#">Home Office</a></li>
            <li><a href="#">Accent Furniture</a></li>
            <li><a href="#">Office Furniture</a></li>
          </ul>
        </li>
  </ul>
</div>

<div class="navbar navbar-default navbar-fixed-top">
  <button type="button" class="navbar-toggle" data-toggle="offcanvas" data-target=".navmenu" data-canvas="body">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
</div>


<nav class="navbar navbar-default navbar-fixed-top hidden-xs">
    <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"><img src="images/logo.png" width="54"></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Shop <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Furniture</a>
                            <ul class="dropdown-menu">
                                <li><a href="products.html">Living Room</a></li>
                                <li><a href="products.html">Dining Room and Kitchen</a></li>
                                <li><a href="products.html">Bed Room</a></li>
                                <li><a href="products.html">Home Office</a></li>
                                <li><a href="products.html">Accent Furniture</a></li>
                                <li><a href="products.html">Office Furniture</a></li>
                            </ul>
                        </li>
                        <li><a href="products.html">Bedding</a></li>
                        <li><a href="products.html">Lighting</a></li>
                        <li><a href="products.html">Pillow and Decor</a></li>
                        <li><a href="products.html">Wall Art and Mirror</a></li>
                        <li><a href="products.html">Table Top</a></li>
                        <li><a href="products.html">Glassware</a></li>
                    </ul>
                </li>
                <li><a href="photos.html">Photos</a></li>
                <li><a href="articles.html">Stories</a></li>
                <li><a href="questions.html">FAQs</a></li>
                <li><a href="contact.html">Contact Us</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <img src="images/cart.png"> <span class="badge">2</span> </a></a>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <div class="cart-flyout">
                                <h4 class="text-roboto">Your Basket</h4>
                                <div class="row">
                                    <div class="col-sm-3 col-xs-3 less-padding">
                                        <img src="images/stool1.jpg" width="100%">
                                    </div>
                                    <div class="col-sm-8 col-xs-9">
                                        <span class="text-gray-1">Vee Bar Stool</span>
                                        <p class="text-gray-2">1 x 1.000.000</p>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-sm-3 col-xs-3 less-padding">
                                        <img src="images/vintage.jpg" width="100%">
                                    </div>
                                    <div class="col-sm-8 col-xs-9">
                                        <span class="text-gray-1">Vintage 50's</span>
                                        <p class="text-gray-2">1 x 2.000.000</p>
                                    </div>

                                </div>

                                <div class="row less-padding" style="background: #3E3F44;">
                                    <div class="col-sm-6 col-xs-6 less-padding"><h4><small style="color: #C9C9C9;">Total</small><br><span style="color:#fff; font: 18px Helvetica">IDR 3.000.000</span></h4></div>
                                    <div class="col-sm-6 col-xs-6 less-padding">
                                        <a href="shoppingCart.html" class="button-review-cart btn pull-right">View Cart</a>
                                    </div>
                                </div>

                            </div>
                        </li>
                    </ul>
                </li>
                <li><a href="#">Search</a></li>

            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>



<div class="container">

    <div class="kimi-container">
        <!--breadcrumb start-->
        <ol class="breadcrumb hidden-xs">
            <li><a href="index.html">Home</a></li>
            <li><a href="shoppingCart.html">Cart</a></li>
            <li><a href="checkout1.html">Customer Information</a></li>
            <li><a href="checkout2.html">Shipping Method</a></li>
            <li>Payment Method</li>
        </ol>

        <div class="box-bg-gray visible-xs less-padding-left">
            <i class="fa fa-shopping-cart" aria-hidden="true"></i>

            <a style="margin-right: 15px;" class="text-black" role="button" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                Show Order Summary <i class="fa fa-angle-down" aria-hidden="true"></i>
            </a>

            <strong class="pull-right">IDR 3.100.000</strong>

            <div class="clearfix"></div>
            <div class="collapse" id="collapseExample">
                <div class="row">
                    <div class="box-bg-gray">
                        <div class="row">
                            <div class="col-xs-3">
                                <img src="images/stool1.jpg" width="100%">
                            </div>
                            <div class="col-xs-5">
                                <span>Vee Bar Stool</span><br/>
                                <small>Sellemore</small>
                            </div>
                            <div class="col-xs-4">
                                <p class="text-right">IDR 1.000.000</p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-3">
                                <img src="images/vintage.jpg" width="100%">
                            </div>
                            <div class="col-xs-5">
                                <span>Vintage 50s</span><br/>
                                <small>Sellemore</small>
                            </div>
                            <div class="col-xs-4">
                                <p class="text-right">IDR 2.000.000</p>
                            </div>
                        </div>

                        <hr>

                        <form class="form-inline">
                            <div class="col-xs-8">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="" placeholder="Discount Code">
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <button type="submit" class="btn btn-default button-black-medium">Apply</button>
                            </div>
                        </form>
                        <hr/>

                        <div class="row">
                            <div class="col-xs-6">Subtotal</div>
                            <div class="col-xs-6"><p class="text-right"><strong>IDR 3.000.000</strong></p></div>
                        </div>

                        <div class="row">
                            <div class="col-xs-6">Shipping + Trx Fee</div>
                            <div class="col-xs-6"><p class="text-right"><strong> IDR 100.000 </strong></p></div>
                        </div>

                        <hr/>

                        <div class="pull-left">Total</div>
                        <div class="pull-right"><strong>IDR 3.100.000</strong></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="clearfix"></div>


        <div class="row">
            <div class="col-md-8">

                <div class="">
                    <div class="box-bg-white">
                        <h3 class="section-title">Shipping Address</h3>
                        <div class="row">
                            <div class="col-sm-10">
                                <p class="text-gray-4">Tower 49 Capital, c/o University at Albany Downtown Campus, 207 Sheridan Ave, Albany, NY 12210 USA</p>
                            </div>

                            <div class="col-sm-2">
                                <a href="checkout1.html" class="btn btn-default button-black-medium">Edit</a>
                            </div>
                        </div>


                        <h3 class="section-title">Delivery Window</h3>
                        <div class="row">
                            <div class="col-sm-10">
                                <p class="text-gray-4"><strong style="font-size: 24px" class="text-black">June 24 12:30PM</strong> <span>Delivered by <strong class="text-black">DHL</strong>. <small>* Estimated arrival date.</small></span></p>
                            </div>

                            <div class="col-sm-2">
                                <a href="checkout2.html" class="btn btn-default button-black-medium">Edit</a>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="">
                    <div class="box-bg-white col-md-12">
                        <h3 class="section-title">Payment Options</h3>

                        <div class="radio">
                            <label>
                                <input type="radio" name="paymentMethod" id="paymentMethod1" value="card">
                                <strong>Pay with Credit Card</strong>
                                <img src="/images/card-logos.png" width="50%"/>
                            </label>
                        </div>

                        <div class="clearfix" style="margin-bottom: 30px;"></div>

                        <div class="radio">
                            <label>
                                <input type="radio" name="paymentMethod" id="paymentMethod2" value="usdc">
                                <strong>Pay with USDC</strong>
                                <img src="/images/usdcoin.png" width="18%" />
                            </label>
                        </div>
                    </div>
                </div>
                <a href="checkout2.html" class="btn button-yellow"><i class="fa fa-angle-left" aria-hidden="true"></i> Shipping Method</a>
                <a href="thankyou.html" class="btn btn-default pull-right button-black hidden">Place Order <i class="fa fa-angle-right" aria-hidden="true"></i></a>
                <div class="clearfix maya-small-padding"></div>

            </div>

            <!-- Modal -->
            <div class="modal fade bs-example-modal-lg" id="usdcModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="myModalLabel">
                                <img src="/images/usdcoin_logo.png" height="25px" />
                                Pay with USD Coin</h4>
                        </div>
                        <div class="modal-body ">
                            <!-- <strong>Scan the QR code or copy and paste the payment details into your wallet</strong> -->
                            <h6 class="text-gray-1 text-center">To make a payment, send USDC to the address below</h6>
                            <h1 class="text-center" style="margin-top: 10px;">48.91 USDC</h3>
                            <p class="text-gray-3 text-center">1 USD = 60,216 IDR</p>
                            <!-- QR code is generated dynamically -->
                            <img class="center-block" id="qrCode"/>
                            <p class="text-gray-2">For security and fraud prevention reasons, we require <strong>ten</strong> block confirmations on the ETH blockchain
                            before your payment is marked as complete.</p>
                        </div>
                        <div class="modal-footer">
                            <div class="progress progress-striped active" style="margin-bottom: 0px">
                                <div class="progress-bar" style="width: 100%" id="paymentProgress">
                                    <strong>Awaiting payment...</strong>
                                </div>
                            </div>
                            <p class="text-center text-gray-1" id="confirmationStatus" style="margin-top: 10px; display: none">
                                <mark>
                                    Your payment has received
                                    <strong id="currentConfirms">0</strong> out of <strong id="requiredConfirms">10</strong> confirmations required for verification.
                                </mark>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="box-bg-white">
                    <div class="clearfix maya-small-padding"></div>
                    <h3 class="text-right text-oswald">Need Help?</h3>
                    <p class="text-right text-gray-3 text-medium text-thin">We are here to support you. Call or email us.</p>
                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="text-gray-2 text-thin">Everyday<br>from 9.00 - 18.00</p>
                        </div>
                        <div class="col-md-6">
                            <p class="text-right">+62 21 567898765<br><a class="text-black text-underline" href="mailto: info@info@tilde.id">info@tilde.id</a></p>
                        </div>
                    </div>
                    <div class="clearfix maya-small-padding"></div>
                </div>
            </div>
        </div>
    </div>

</div><!-- /.container -->

<!--include footer-->
<div class="include-footer"></div>


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./js/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="./js/bootstrap.min.js"></script>
<script src="./js/jasny/jasny-bootstrap.js"></script>

<!--kimi basic js-->
<script src="js/kimi.js"></script>

<!--ethereum js-->
<script src="js/ethereum/etherscan.js"></script>

<script>
    const etherscan = new Etherscan('testnet');
    const receiveAddress = "0xD71295169658f5d0e8C19e6B42C14223D54378Ca";
    const qrCodeImage = `https://chart.googleapis.com/chart?chs=350x350&cht=qr&chl=ethereum:${receiveAddress}`;
    let startingBalance = '';
    let pollInterval = null;

    // On page load, get the current address balance so we have a starting point
    getAddressBalanceFormatted(receiveAddress).then((bal) => {
        startingBalance = bal;
    });

    // Show USDC modal when selected as a payment
    $('#paymentMethod2').on('change', function () {
        $('#qrCode').attr('src', qrCodeImage);
        $('#usdcModal').modal({
            keyboard: false,
            backdrop: 'static'
        });

        // Begin polling for balance changes since we expect payment (modal is open)
        pollInterval = setInterval(() => {
            pollForBalanceChanges();
        }, 4000); // every 4s
    });

    async function getAddressBalanceFormatted(address) {
        const balance = await etherscan.getAddressBalance(address).then((res) => {
            return res.result / Math.pow(10, 6);
        });
        return balance;
    }

    function pollForBalanceChanges() {
        getAddressBalanceFormatted(receiveAddress)
            .then(async (currentBalance) => {
                if (currentBalance <= startingBalance) {
                    console.log(`${currentBalance} is lte ${startingBalance}`);
                    return;
                }

                // If the balance increases, fetch the most recent txns
                const transfers =  await etherscan.getMostRecentTokenTransfers(receiveAddress);
                if (transfers.result.length === 0) {
                    console.log('No tx found but address balance went up; likely a pending tx');
                    return;
                }

                // Only look at the most recent receive (rather than sends)
                const newestReceive = transfers.result.find(tx => tx.to == receiveAddress.toLowerCase());
                console.log(`Found a ${newestReceive.value} ${newestReceive.tokenSymbol} receive sent at ${new Date(newestReceive.timeStamp * 1000)}`);

                const currentConfirms = $('#currentConfirms').text();
                const requiredConfirms = $('#requiredConfirms').text();

                if (currentConfirms === '0') {
                    showPaymentVerification();
                }
                $('#currentConfirms').text(newestReceive.confirmations);

                if (newestReceive.confirmations >= requiredConfirms) {
                    clearInterval(pollInterval);
                    completePurchase();
                }
            }).catch((e) => {
                console.error(e);
            });
    }

    function showPaymentVerification() {
        $('#paymentProgress').addClass('progress-bar-success');
        $('#paymentProgress').html('<strong>Verifying payment...</strong>');
        $('#confirmationStatus').show();
    }

    function completePurchase() {
        $('#usdcModal').modal('hide');
        location.href = '/thankyou.html';
    }
</script>

</body>
</html>
